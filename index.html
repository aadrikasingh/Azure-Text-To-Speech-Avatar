<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Avatar Demo</title>

    <!-- Link to external CSS stylesheets -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='image/favicon.ico') }}">

    <!-- Link to external JavaScript files -->
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
    <script src="https://aka.ms/csspeech/jsbrowserpackageraw"></script>

    <!-- Include Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

  <!-- Chat Bubble Icon to toggle chat visibility -->
  <div id="chat-bubble-icon" onclick="toggleChat()">
      <i class="fas fa-comment-dots"></i>
  </div>
  
  <!-- Hidden inputs for client variables -->
  <input id="clientId" type="hidden" value="{{client_id}}">
  <input id="sttLocales" type="hidden" value="{{stt_locales}}">
  <input type="checkbox" id="continuousConversation" style="display: none;">
  <input type="checkbox" id="autoReconnectAvatar" checked style="display: none;">
  <input type="checkbox" id="useLocalVideoForIdle" style="display: none;">
  
  <!-- Main Layout for Avatar and Chat -->
  <div class="main-container">
      <!-- Logo Container -->
      <div class="logo-container">
          <img src="{{ url_for('static', filename='image/logo.png') }}" alt="Logo" class="logo">
      </div>
  
      <!-- Video container that holds both local and remote videos -->
      <div id="videoContainer"> 
          <!-- Local video for idle state -->
          <div id="localVideo" hidden>
              <video src="{{ url_for('static', filename='video/lisa-casual-sitting-idle.mp4') }}" autoplay loop muted></video>
          </div>
  
          <!-- Remote video feed -->
          <div id="remoteVideo"></div>
      </div>
  
      <!-- Buttons for controlling avatar session and microphone interaction -->
      <div class="button-container">
          <button id="startSession" class="icon-button" onclick="window.startSession()">
              <i class="fas fa-play-circle"></i>
          </button>
          <button id="microphone" class="icon-button" onclick="window.microphone()" disabled>
              <i class="fas fa-microphone"></i>
          </button>
          <button id="stopSpeaking" class="icon-button" onclick="stopSpeaking()" disabled>
              <i class="fas fa-stop-circle"></i>
          </button>
          <button id="clearChatHistory" class="icon-button" onclick="window.clearChatHistory()">
              <i class="fas fa-trash-alt"></i>
          </button>
          <button id="stopSession" class="icon-button" onclick="window.stopSession()" disabled>
              <i class="fas fa-times-circle"></i>
          </button>
      </div>
  
      <!-- Chat History and Message Box (Initially Hidden) -->
      <div id="chat-box" class="chat-container" style="display: none;">
          <!-- Overlay for chat history -->
          <textarea id="chatHistory"></textarea>
          <!-- Overlay for latency logs; -->
          <textarea id="latencyLog" hidden></textarea>
          <!-- Type Message Checkbox -->
          <div id="showTypeMessageCheckbox">
            <input type="checkbox" id="showTypeMessage" onchange="window.updateTypeMessageBox()"> Type Message</input><br />
          </div>
          <!-- Type Message Box -->
          <textarea id="userMessageBox" rows="3" placeholder="Type a message..."></textarea>
      </div>
  </div>
  
  <!-- JavaScript for Toggle and Sending Messages -->
  <script>
      // Toggle the chat dialog visibility
      function toggleChat() {
          const chatBox = document.getElementById("chat-box");
          chatBox.style.display = chatBox.style.display === "none" ? "flex" : "none";
      }
  </script>
  
  </body>  
  
</html>
